<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Dishadding</title>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script type="text/javascript" src="dist/jquery.scrollUp.js"></script>
    <script>
    var Ara = [];
 $(document).ready(function(){

 $.ajax({
                url:"http://localhost:8080/get-ingredients",
                type: "get",
                success: function(data){
                    $.each(data,function(id,obj){

                    Ara.push(obj);



                        var s1="<input type=\"checkbox\" name=\"dx\" id=\""+obj.id+"\""+">"+ obj.ingredientsName +"<input type=\"text\" name=\"dx\" id=\""+obj.id+"A" +"\""+"> "+"<br>";


                        $(s1).appendTo('#s1');
                         })}
                  });
           })

function saveIng(){


              var ingredientsName = $("#1").val();
              var priceIngredients = $("#2").val();

              var object ={
              "ingredientsName":ingredientsName,
              "priceIngredients":priceIngredients
              };

              var jsonObject=JSON.stringify(object);

              $.ajax({

              url:"http://localhost:8080/save-ingredients",
              type:"post",
              data: jsonObject,
              contentType:"application/json;",

              dataType: "application/json"



          })





            }


function CheckName(){


              var ingredientsName = $("#1").val();



              $.ajax({

              url:"http://localhost:8080/check-name",
              type:"get",
              data: {
              "ingredientsName":ingredientsName

              },
          success: function(response) {
     if(response==false){
     alert('you can not add this ingredient');}
                 else   { alert("good");}

     }



          })





            }
function start(){
var someObj=[];
let tot = "";

$("input:checkbox").each(function(){
    var $this = $(this);

    if($this.is(":checked")){


    for (var i in Ara){
    if (Ara[i].id == ($this.attr("id"))){
    someObj.push(Ara[i]);
    var ing = $this.attr("id")+"A";
    var q =document.getElementById(ing).value;
    tot += q+"A";
    console.log(tot);
    }

    }

    }
});


              var dishName = $("#dishName").val();


              var object ={
              "dishName":dishName,
              "ingredients":someObj,
              "ingredientsQuan":tot
              };

              var jsonObject=JSON.stringify(object);

              $.ajax({

              url:"http://localhost:8080/save-dish",
              type:"post",
              data: jsonObject,
              contentType:"application/json;",

              dataType: "application/json"



          })
}









    </script>


</head>
<body>
<P>add ingredients</P>
<p>name</p>
<br>
<input id="1">
<p>price</p>
<input id="2">
<button type="button" onclick="saveIng();CheckName()">Add ingredient</button>

<form action="/action_page.php" id="s1">
</form>

<p></p>

<input type="text" id="dishName" >
<button type="button" onclick="start()">Start the function</button>
</body>
</html>